[build-system]
requires = [
    "hatchling",
    "hatch-conda",
    "hatch-vcs",
    "bleach",
    "bokeh >=3.1.1,<3.3.0",
    "cryptography <39",  # Avoid pyOpenSSL issue
    "packaging",
    "param >=1.9.2",  # TODO: still required?
    "pyviz_comms >=0.7.4",
    "requests",
    "tqdm >=4.48.0",
    "urllib3 <2.0",  # See: https://github.com/holoviz/panel/pull/4979
]
build-backend = "hatchling.build"

[project]
name = "panel"
dynamic = ["version"]
description = "The powerful data exploration & web app framework for Python."
readme = "README.md"
license = { file = "LICENSE.txt" }
requires-python = ">=3.8"
authors = [
    { name = "HoloViz", email = "developers@holoviz.org" },
]
maintainers = [
    { name = "HoloViz", email = "developers@holoviz.org" },
]
classifiers = [
    "Development Status :: 5 - Production/Stable",
    "License :: OSI Approved :: BSD License",
    "Intended Audience :: Developers",
    "Intended Audience :: Financial and Insurance Industry",
    "Intended Audience :: Healthcare Industry",
    "Intended Audience :: Information Technology",
    "Intended Audience :: Legal Industry",
    "Intended Audience :: Other Audience",
    "Intended Audience :: Science/Research",
    "License :: OSI Approved :: BSD License",
    "Natural Language :: English",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.8",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Topic :: Office/Business",
    "Topic :: Office/Business :: Financial",
    "Topic :: Scientific/Engineering",
    "Topic :: Scientific/Engineering :: Information Analysis",
    "Topic :: Scientific/Engineering :: Visualization",
    "Topic :: Software Development :: Libraries",
]
dependencies = [
    "bleach",
    "bokeh >=3.1.1,<3.3.0",
    "markdown",
    "markdown-it-py",
    "mdit-py-plugins",
    "linkify-it-py",
    "pandas >=1.2",
    "param >=1.12.0",
    "pyviz_comms >=0.7.4",
    "requests",
    "tqdm >=4.48.0",
    "typing_extensions",
    "xyzservices >=2021.09.1", # Bokeh dependency, but pyodide 23.0.0 does not always pick it up
]

[project.optional-dependencies]
all = [
    "panel[doc]",
    "panel[examples]",
    "panel[recommended]",
    "panel[tests]",
    "panel[ui]"
]
build = [
    "hatchling",
    "hatch-vcs",
    "panel",
]
doc = [
    "panel[recommended]",
    "nbsite ==0.8.2",
    "lxml",
]
examples = [
    "aiohttp",
    "altair",
    "channels",
    "croniter",
    "datashader",
    "django <4",
    "fastparquet",
    "folium",
    "holoviews >=1.16.0",
    "hvplot",
    "ipyleaflet",
    "ipympl",
    "ipyvolume",
    "ipyvuetify",
    "ipywidgets",
    "ipywidgets_bokeh",
    "jupyter_bokeh >=3.0.7",
    "networkx >=2.5",
    "plotly >=4.0",
    "pydeck",
    "pyecharts",
    "pyinstrument >=4.0",
    "pyvista",
    "reacton",
    "scipy",
    "scikit-image",
    "scikit-learn",
    "seaborn",
    "streamz",
    "vega_datasets",
    "xarray",
]
pip-extras = [
    "ipywidgets_bokeh",
    "playwright",
    "pydeck",
    "pyecharts",
    "pytest-playwright",
    "reacton",
    "vega_datasets",
]
conda-extras = [
    "nodejs >=16",
    # TODO: re-add vtk
    # "vtk",
    "xgboost"
]
recommended = [
    "holoviews >=1.16.0",
    "jupyterlab",
    "matplotlib",
    "pillow",
    "plotly",
]
tests = [
    "flake8",
    "flaky",
    "ipython >=7.0",
    "nbval",
    "parameterized",
    "pre-commit",
    "psutil",
    "pytest",
    "pytest-asyncio",
    "pytest-cov",
    "pytest-xdist",
    "twine",
    # Libraries tested in unit tests
    "altair",
    "anywidget",
    "folium",
    "diskcache",
    "holoviews >=1.16.0",
    "ipympl",
    "ipython >=7.0",
    "ipyvuetify",
    "ipywidgets_bokeh",
    "numpy",
    "pandas >=1.3",
    "reacton",
    "scipy",
    "twine",
]
ui = [
    "jupyter_server",
    "playwright",
    "pytest-playwright",
]

[project.scripts]
panel = "panel.command:main"

[project.urls]
Homepage = "http://panel.holoviz.org"
Source = "https://github.com/holoviz/panel"

[tool.hatch.version]
source = "vcs"

[tool.hatch.build.hooks.custom]

[tool.hatch.build]
ignore-vcs = true

[tool.hatch.build.targets.wheel.shared-data]
"jupyter-config/jupyter_notebook_config.d" = "etc/jupyter/jupyter_notebook_config.d"
"jupyter-config/jupyter_server_config.d" = "etc/jupyter/jupyter_server_config.d"

[tool.hatch.build.targets.sdist]
include = [
    "/panel"
]

[tool.ruff]
exclude = [
    ".git",
    "__pycache__",
    ".tox",
    ".eggs",
    "*.egg",
    "doc",
    "dist",
    "build",
    "_build",
    "examples",
    ".ipynb_checkpoints",
    "node_modules",
    "apps",
]
ignore = [
    "E402",
    "E712",
    "E731",
    "E741",
    "W605",
    "E701", # Multiple statements on one line
]
line-length = 165
select = [
    "E",
    "F",
    "W",
]

[tool.ruff.per-file-ignores]
"panel/tests/ui/jupyter_server_test_config.py" = ["F821"]

[tool.codespell]
ignore-words-list = "nd,doubleclick"
skip = "doc/generate_modules.py,examples/reference/templates/FastGridTemplate.ipynb"
write-changes = true

[tool.isort]
force_grid_wrap = 4
multi_line_output = 5
combine_as_imports = true
lines_between_types = 1
include_trailing_comma = true

[tool.pytest.ini_options]
addopts = "-v --pyargs --doctest-ignore-import-errors"
norecursedirs = "doc .git dist build _build .ipynb_checkpoints panel/examples"
xfail_strict = true
